'use strict';var _0x2e3ecb=_0x2714;function _0xe539(){var _0x1dc3fd=['sVfTy','TokenExpiredError','Roles','status','../models/index','length','CCzxf','some','5943ZeaNPE','/refresh-token','headers','4125YpjEbi','/participant/all','default','url','1730175qGLnuC','Bearer','split','[Not\x20authenticated\x20the\x20user]\x20JWT\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20ở\x20header\x20request.\x20Vui\x20lòng\x20login,\x20hoặc\x20kiểm\x20tra\x20header\x20request\x20đã\x20truyền\x20JWT\x20chưa\x20?','email','path','12jjBumB','1877416arKgqJ','gONLu','cookies','lodash','delay','access_token','JWT_SECRET','includes','14460TYnfKp','12648eGwffs','__esModule','264483DuZDGs','verify','exports','you\x20don\x27t\x20permission\x20to\x20access\x20this\x20resource...','837713lwulgB','user','/login','CSTch','1794xDGnSw','env','200iJKxvb','/account','/participant','JWT\x20Token\x20đã\x20hết\x20hạn.\x20Bạn\x20cần\x20dùng\x20Refresh_Token\x20để\x20lấy\x20token\x20mới,\x20or\x20Login\x20lại\x20và\x20sử\x20dụng\x20Access_Token\x20mới\x20:v','json','authorization','uuid','body','jsonwebtoken','groupWithRoles'];_0xe539=function(){return _0x1dc3fd;};return _0xe539();}(function(_0x5dd7f9,_0x255ee0){var _0x1935d4=_0x2714,_0x44a6bd=_0x5dd7f9();while(!![]){try{var _0x48e9d1=-parseInt(_0x1935d4(0x8b))/0x1+-parseInt(_0x1935d4(0xba))/0x2*(-parseInt(_0x1935d4(0xb0))/0x3)+parseInt(_0x1935d4(0xb1))/0x4+parseInt(_0x1935d4(0xaa))/0x5+-parseInt(_0x1935d4(0x8f))/0x6*(-parseInt(_0x1935d4(0xa3))/0x7)+-parseInt(_0x1935d4(0x91))/0x8*(-parseInt(_0x1935d4(0xbc))/0x9)+-parseInt(_0x1935d4(0xb9))/0xa*(parseInt(_0x1935d4(0xa6))/0xb);if(_0x48e9d1===_0x255ee0)break;else _0x44a6bd['push'](_0x44a6bd['shift']());}catch(_0x343c01){_0x44a6bd['push'](_0x44a6bd['shift']());}}}(_0xe539,0x6dae0));var _jsonwebtoken=_interopRequireDefault(require(_0x2e3ecb(0x99))),_lodash=require(_0x2e3ecb(0xb4)),_uuid=require(_0x2e3ecb(0x97)),_index=_interopRequireDefault(require(_0x2e3ecb(0x9f))),_bcryptjs=_interopRequireDefault(require('bcryptjs'));function _0x2714(_0x12b18a,_0x26a7a4){var _0xe539ba=_0xe539();return _0x2714=function(_0x271452,_0x2d07c7){_0x271452=_0x271452-0x8a;var _0x140ec0=_0xe539ba[_0x271452];return _0x140ec0;},_0x2714(_0x12b18a,_0x26a7a4);}function _interopRequireDefault(_0x2bf71c){var _0x2ef67f=_0x2e3ecb;return _0x2bf71c&&_0x2bf71c[_0x2ef67f(0xbb)]?_0x2bf71c:{'default':_0x2bf71c};}require('dotenv')['config']();var nonSecurePaths=['/logout',_0x2e3ecb(0x8d),'/register',_0x2e3ecb(0xa4),_0x2e3ecb(0x93),_0x2e3ecb(0xa7)],verifyToken=function(_0x4f8486){var _0x3f6d45=_0x2e3ecb,_0x1baafd=process[_0x3f6d45(0x90)][_0x3f6d45(0xb7)],_0x317872=null;try{_0x317872=_jsonwebtoken[_0x3f6d45(0xa8)][_0x3f6d45(0xbd)](_0x4f8486,_0x1baafd);}catch(_0x52575d){if(_0x52575d instanceof _jsonwebtoken[_0x3f6d45(0xa8)][_0x3f6d45(0x9c)])return _0x3f6d45(0x9c);}return _0x317872;},extractToken=function(_0x2165d7){var _0x38b8ec=_0x2e3ecb;return _0x2165d7['headers'][_0x38b8ec(0x96)]&&_0x38b8ec(0xab)===_0x2165d7[_0x38b8ec(0xa5)][_0x38b8ec(0x96)][_0x38b8ec(0xac)]('\x20')[0x0]?_0x2165d7[_0x38b8ec(0xa5)][_0x38b8ec(0x96)][_0x38b8ec(0xac)]('\x20')[0x1]:null;},checkUserJWT=function(_0x22c52b,_0x5c4570,_0x549ce3){var _0x599acc=_0x2e3ecb;if(nonSecurePaths['includes'](_0x22c52b[_0x599acc(0xaf)]))return _0x549ce3();var _0x849f59=_0x22c52b[_0x599acc(0xb3)],_0x37ea04=extractToken(_0x22c52b);return _0x849f59&&_0x849f59[_0x599acc(0xb6)]||_0x37ea04?(_0x849f59=_0x849f59&&_0x849f59[_0x599acc(0xb6)]?_0x849f59[_0x599acc(0xb6)]:_0x37ea04,(_0x37ea04=verifyToken(_0x849f59))&&_0x599acc(0x9c)!==_0x37ea04?(_0x22c52b['user']=_0x37ea04,void _0x549ce3()):_0x37ea04&&_0x599acc(0x9c)===_0x37ea04?_0x5c4570[_0x599acc(0x9e)](0x195)[_0x599acc(0x95)]({'EC':-0x3e7,'DT':'','EM':_0x599acc(0x94)}):_0x5c4570[_0x599acc(0x9e)](0x191)[_0x599acc(0x95)]({'EC':-0x1,'DT':'','EM':'[Not\x20authenticated\x20the\x20user]\x20JWT\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20ở\x20header\x20request.\x20Vui\x20lòng\x20login,\x20hoặc\x20kiểm\x20tra\x20header\x20request\x20đã\x20truyền\x20JWT\x20chưa\x20?'})):_0x5c4570[_0x599acc(0x9e)](0x191)[_0x599acc(0x95)]({'EC':-0x1,'DT':'','EM':_0x599acc(0xad)});},checkUserPermission=function(_0x1cc263,_0x29e47d,_0x44fc33){var _0x27d34a=_0x2e3ecb;return nonSecurePaths[_0x27d34a(0xb8)](_0x1cc263[_0x27d34a(0xaf)])||_0x27d34a(0x92)===_0x1cc263[_0x27d34a(0xaf)]?_0x44fc33():_0x1cc263['user']?(_0x1cc263[_0x27d34a(0x8c)][_0x27d34a(0xae)],_0x23a30d=_0x1cc263[_0x27d34a(0x8c)][_0x27d34a(0x9a)][_0x27d34a(0x9d)],_0x3d145e=_0x1cc263['path'],!_0x23a30d||0x0===_0x23a30d[_0x27d34a(0xa0)]||!0x0!==_0x23a30d[_0x27d34a(0xa2)](function(_0xb58689){var _0x2ef827=_0x27d34a;if(_0x2ef827(0x8e)!==_0x2ef827(0x9b))return _0xb58689[_0x2ef827(0xa9)]===_0x3d145e||_0x3d145e[_0x2ef827(0xb8)](_0xb58689[_0x2ef827(0xa9)]);else{if(_0x26df90 instanceof _0x5ba51e[_0x2ef827(0xa8)]['TokenExpiredError'])return _0x2ef827(0x9c);}})?_0x29e47d['status'](0x193)[_0x27d34a(0x95)]({'EC':-0x1,'DT':'','EM':_0x27d34a(0x8a)}):void _0x44fc33()):_0x29e47d[_0x27d34a(0x9e)](0x191)['json']({'EC':-0x1,'DT':'','EM':'[Not\x20authenticated\x20the\x20user]\x20JWT\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20ở\x20header\x20request.\x20Vui\x20lòng\x20login,\x20hoặc\x20kiểm\x20tra\x20header\x20request\x20đã\x20truyền\x20JWT\x20chưa\x20?'});var _0x23a30d,_0x3d145e;},addDelay=function(_0x419f46,_0x551ea1,_0x1b0356){var _0x3aca75=_0x2e3ecb,_0x2ba131;null!=_0x419f46&&null!=(_0x2ba131=_0x419f46['body'])&&_0x2ba131[_0x3aca75(0xb5)]?setTimeout(function(){var _0x4818cb=_0x3aca75;_0x4818cb(0xa1)!==_0x4818cb(0xb2)?_0x1b0356():_0x1068f0=_0x331d99['default'][_0x4818cb(0xbd)](_0x15e07a,_0x27785d);},+_0x419f46[_0x3aca75(0x98)][_0x3aca75(0xb5)]):_0x1b0356();};module[_0x2e3ecb(0xbe)]={'checkUserJWT':checkUserJWT,'checkUserPermission':checkUserPermission,'addDelay':addDelay};